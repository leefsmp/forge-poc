(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{313:function(e,t,n){"use strict";n.r(t);n(499);t.default="Viewing.Extension.BarChart"},328:function(e,t,n){"use strict";var o=n(13),a=n(22),i=n(4),r=n(5),s=n(8),l=n(7),d=n(325),c=n(9),u=n(2),h=function(e){function t(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(i.a)(this,t),(n=Object(s.a)(this,Object(l.a)(t).call(this,e))).onModelCompletedLoad=n.onModelCompletedLoad.bind(Object(u.a)(Object(u.a)(n))),n.onObjectTreeCreated=n.onObjectTreeCreated.bind(Object(u.a)(Object(u.a)(n))),n.onModelRootLoaded=n.onModelRootLoaded.bind(Object(u.a)(Object(u.a)(n))),n.onExtensionLoaded=n.onExtensionLoaded.bind(Object(u.a)(Object(u.a)(n))),n.onModelActivated=n.onModelActivated.bind(Object(u.a)(Object(u.a)(n))),n.onGeometryLoaded=n.onGeometryLoaded.bind(Object(u.a)(Object(u.a)(n))),n.onToolbarCreated=n.onToolbarCreated.bind(Object(u.a)(Object(u.a)(n))),n.onModelBeginLoad=n.onModelBeginLoad.bind(Object(u.a)(Object(u.a)(n))),n.onModelUnloaded=n.onModelUnloaded.bind(Object(u.a)(Object(u.a)(n))),n.onSelection=n.onSelection.bind(Object(u.a)(Object(u.a)(n))),n.__onLoadNodeProperties=n.__onLoadNodeProperties.bind(Object(u.a)(Object(u.a)(n))),n.__onModelRootLoaded=n.__onModelRootLoaded.bind(Object(u.a)(Object(u.a)(n))),n.__onModelActivated=n.__onModelActivated.bind(Object(u.a)(Object(u.a)(n))),n.__onModelUnloaded=n.__onModelUnloaded.bind(Object(u.a)(Object(u.a)(n))),n.__onModelLoaded=n.__onModelLoaded.bind(Object(u.a)(Object(u.a)(n))),n.models=e.impl.modelQueue().getModels(),n.defaultOptions=r,n.options=Object(a.a)({},r,o),n.react=n.options.react,n.viewer=e,n.initializeEvents(),n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"load",value:function(){return this.options.contextMenu&&this.onContextMenu&&this.options.contextMenu.addHandler(this.onContextMenu),!0}},{key:"unload",value:function(){var e=this;return this.options.contextMenu&&this.onContextMenu&&this.options.contextMenu.removeHandler(this.onContextMenu),this.viewerEvents.forEach(function(t){e.viewer.removeEventListener(t.id,e[t.handler])}),this.eventSink&&(this.eventSink.off("MetaProperties:loadNodeProperties",this.__onLoadNodeProperties),this.eventSink.off("model.activated",this.__onModelActivated),this.eventSink.off("model.unloaded",this.__onModelUnloaded),this.eventSink.off("model.loaded",this.__onModelLoaded)),this.off(),!0}},{key:"onExtensionLoaded",value:function(e){}},{key:"onModelBeginLoad",value:function(e){}},{key:"onModelActivated",value:function(e){}},{key:"__onModelRootLoaded",value:function(e){var t=this;this.viewerEvent([Autodesk.Viewing.OBJECT_TREE_CREATED_EVENT,Autodesk.Viewing.GEOMETRY_LOADED_EVENT]).then(function(e){t.onModelCompletedLoad(e[0])})}},{key:"onModelRootLoaded",value:function(e){}},{key:"onObjectTreeCreated",value:function(e){}},{key:"onGeometryLoaded",value:function(e){}},{key:"onModelCompletedLoad",value:function(e){}},{key:"onToolbarCreated",value:function(e){}},{key:"onModelUnloaded",value:function(e){}},{key:"onSelection",value:function(e){}},{key:"__onLoadNodeProperties",value:function(e){var t=e.dbId,n=e.properties;if(this.onLoadNodeProperties)return this.onLoadNodeProperties(t,n)}},{key:"__onModelLoaded",value:function(e){this.models=Object(o.a)(this.models).concat([e.model]),this.onModelBeginLoad(e)}},{key:"__onModelActivated",value:function(e){this.onModelActivated(e)}},{key:"__onModelUnloaded",value:function(e){this.models=this.models.filter(function(t){return t.guid!==e.model.guid}),this.onModelUnloaded(e)}},{key:"initializeEvents",value:function(){var e=this;this.options.eventSink&&(this.eventSink=this.options.eventSink,this.eventSink.on("MetaProperties:loadNodeProperties",this.__onLoadNodeProperties),this.eventSink.on("model.loaded",this.__onModelLoaded),this.eventSink.on("model.activated",this.__onModelActivated),this.eventSink.on("model.unloaded",this.__onModelUnloaded)),this.viewerEvents=[{id:Autodesk.Viewing.EXTENSION_LOADED_EVENT,handler:"onExtensionLoaded"},{id:Autodesk.Viewing.OBJECT_TREE_CREATED_EVENT,handler:"onObjectTreeCreated"},{id:Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT,handler:"__onModelRootLoaded"},{id:Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT,handler:"onModelRootLoaded"},{id:Autodesk.Viewing.GEOMETRY_LOADED_EVENT,handler:"onGeometryLoaded"},{id:Autodesk.Viewing.TOOLBAR_CREATED_EVENT,handler:"onToolbarCreated"}],this.options.controlledSelection||this.viewerEvents.push({id:Autodesk.Viewing.AGGREGATE_SELECTION_CHANGED_EVENT,handler:"onSelection"}),this.viewerEvents.forEach(function(t){e.viewerEvent(t.id,e[t.handler])})}},{key:"viewerEvent",value:function(e,t){var n=this;if(!t){var o=(Array.isArray(e)?e:[e]).map(function(e){return new Promise(function(t){n.viewer.addEventListener(e,function o(a){n.viewer.removeEventListener(e,o),t(a)})})});return Promise.all(o)}this.viewer.addEventListener(e,t)}},{key:"emit",value:function(e,n){return this.options.eventSink?this.options.eventSink.emit(e,n):Object(d.a)(Object(l.a)(t.prototype),"emit",this).call(this,e,n)}},{key:"emitAcc",value:function(e,n){return this.options.eventSink?this.options.eventSink.emitAcc(e,n):Object(d.a)(Object(l.a)(t.prototype),"emitAcc",this).call(this,e,n)}}],[{key:"ExtensionId",get:function(){return"Viewing.Extension.MultiModelExtensionBase"}}]),t}(n(30).a.Composer(Autodesk.Viewing.Extension));t.a=h},333:function(e,t,n){var o=n(334);"string"===typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(21)(o,a);o.locals&&(e.exports=o.locals)},334:function(e,t,n){(e.exports=n(20)(!1)).push([e.i,".widget-container {\n  position: relative;\n  height: 100%;\n  width: 100%; }\n\n.widget-container > .title {\n  border-bottom: 1px solid #cdcdcd;\n  background-color: #f5f5f5;\n  padding-right: 10px;\n  color: black;\n  position: relative;\n  overflow: hidden;\n  text-align: left;\n  height: 40px;\n  width: 100%; }\n\n.widget-container > .title > label {\n  white-space: nowrap;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  margin-left: 27px;\n  margin-top: 10px; }\n\n.widget-container > .content {\n  position: relative;\n  overflow: hidden;\n  height: 100%;\n  width: 100%; }\n",""])},336:function(e,t,n){"use strict";var o=n(13),a=n(4),i=n(5),r=n(8),s=n(7),l=n(9),d=n(6),c=(n(333),n(0)),u=n.n(c),h=function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(i.a)(t,[{key:"renderTitle",value:function(){return this.props.showTitle?this.props.renderTitle?this.props.renderTitle():u.a.createElement("div",{className:"title"},u.a.createElement("label",null,this.props.title)):u.a.createElement("div",null)}},{key:"renderChildren",value:function(){var e=this;return this.props.dimensions?u.a.Children.map(this.props.children,function(t){var n=Object.assign({},t.props,{dimensions:e.props.dimensions});return u.a.cloneElement(t,n)}):this.props.children}},{key:"render",value:function(){var e=["widget-container"].concat(Object(o.a)(this.props.className.split(" "))),t=this.props.showTitle?"calc(100% - 40px)":"100%";return u.a.createElement("div",{className:e.join(" "),style:this.props.style},this.renderTitle(),u.a.createElement("div",{className:"content",style:{height:t}},this.renderChildren()))}}]),t}(u.a.PureComponent);Object(d.a)(h,"defaultProps",{showTitle:!0,className:""});var p=h;t.a=p},499:function(e,t,n){"use strict";(function(e){var t=n(3),o=n.n(t),a=n(10),i=n(4),r=n(5),s=n(8),l=n(7),d=n(325),c=n(9),u=n(2),h=n(328),p=n(394),v=n.n(p),f=n(388),b=n.n(f),m=n(336),g=(n(500),n(442)),y=n.n(g),w=n(344),E=n.n(w),O=n(502),k=n(45),x=n(0),j=n.n(x),M=n(404),_=n.n(M),T=n(41),L=function(t){function n(e,t){var o;return Object(i.a)(this,n),(o=Object(s.a)(this,Object(l.a)(n).call(this,e,t))).toggleTheming=o.toggleTheming.bind(Object(u.a)(Object(u.a)(o))),o.onStopResize=o.onStopResize.bind(Object(u.a)(Object(u.a)(o))),o.renderTitle=o.renderTitle.bind(Object(u.a)(Object(u.a)(o))),o.render=o.render.bind(Object(u.a)(Object(u.a)(o))),o.react=t.react,o}return Object(c.a)(n,t),Object(r.a)(n,[{key:"load",value:function(){var e=this;return this.react.setState({activeProperty:"",showLoader:!0,disabled:!1,theming:!1,items:[],data:[]}).then(function(){e.react.pushRenderExtension(e);var t=e.viewer.activeModel||e.viewer.model;t&&e.loadChart(t)}),this.viewer.loadDynamicExtension("Viewing.Extension.ContextMenu",{buildMenu:function(t){return t.map(function(t){return"show all objects"===t.title.toLowerCase()?{title:"Show All objects",target:function(){e.viewer.isolate(),e.viewer.fitToView()}}:t})}}),console.log("Viewing.Extension.BarChart loaded"),!0}},{key:"unload",value:function(){return console.log("Viewing.Extension.BarChart unloaded"),this.react.getState().theming&&this.toggleTheming(),this.react.popRenderExtension(this),Object(d.a)(Object(l.a)(n.prototype),"unload",this).call(this),!0}},{key:"loadChart",value:function(){var t=Object(a.a)(o.a.mark(function t(n){var a,i,r,s=this;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.react.setState({showLoader:!0});case 2:if(n.getData().instanceTree){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,Object(T.b)(n);case 6:if(this.componentIds=t.sent,t.t0=this.options.chartProperties,t.t0){t.next=12;break}return t.next=11,Object(T.c)(this.viewer,this.componentIds,n);case 11:t.t0=t.sent;case 12:return a=t.t0,e("#bar-chart-dropdown").parent().find("ul").css({height:Math.min(e(".bar-chart").height()-42,26*a.length+16)}),t.next=16,this.react.setState({items:a});case 16:return this.setActiveProperty(a[this.options.defaultIndex||0]),t.next=19,Object(T.a)(n,this.componentIds);case 19:i=t.sent,this.fragIdToMaterial={},r=n.getFragmentList(),i.forEach(function(e){var t=r.getMaterial(e);t&&(s.fragIdToMaterial[e]=t)});case 23:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"onModelActivated",value:function(e){"model.loaded"!==e.source&&this.loadChart(e.model)}},{key:"onModelCompletedLoad",value:function(e){this.loadChart(e.model)}},{key:"toggleTheming",value:function(){var e=this,t=this.react.getState(),n=!t.theming;if(this.react.setState({theming:n}),n)t.data.forEach(function(t){t.dbIds.forEach(function(n){var o=e.viewer.activeModel||e.viewer.model;Object(T.i)(o,n,t.material)})});else for(var o in this.fragIdToMaterial){var a=this.fragIdToMaterial[o];(this.viewer.activeModel||this.viewer.model).getFragmentList().setMaterial(o,a)}this.viewer.impl.invalidate(!0,!1,!1)}},{key:"setActiveProperty",value:function(){var e=Object(a.a)(o.a.mark(function e(t,n){var a,i,r=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.react.getState(),e.next=3,this.react.setState({activeProperty:n?t:"",disabled:n,showLoader:!0});case 3:return e.next=5,this.buildPropertyData(t);case 5:return i=e.sent,e.next=8,this.react.setState({activeProperty:t,showLoader:!1,guid:this.guid(),disabled:!1,data:i});case 8:a.theming&&(i.forEach(function(e){e.dbIds.forEach(function(t){var n=r.viewer.activeModel||r.viewer.model;Object(T.i)(n,t,e.material)})}),this.viewer.impl.invalidate(!0,!1,!1));case 9:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"createMaterial",value:function(e){var t=parseInt(e.replace("#",""),16),n={shading:THREE.FlatShading,name:this.guid(),specular:t,shininess:0,emissive:0,diffuse:0,color:t},o=new THREE.MeshPhongMaterial(n);return this.viewer.impl.matman().addMaterial(n.name,o,!0),o}},{key:"groupMap",value:function(e,t,n,o){return y()(e,function(e,a,i){100*a.length/n<o?e[t]=(e[t]||[]).concat(a):e[i]=a})}},{key:"buildPropertyData",value:function(){var e=Object(a.a)(o.a.mark(function e(t){var n,a,i,r,s,l,d,c=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.viewer.activeModel||this.viewer.model,e.next=3,Object(T.g)(n,t,this.componentIds);case 3:for(i in a=e.sent)(!i.length||i.indexOf("<")>-1)&&delete a[i];return r=this.groupMap(a,"Other",this.componentIds.length,2),s=Object.keys(r),l=_.a.scale.linear().domain([0,.33*s.length,.66*s.length,s.length]).range(["#FCB843","#C2149F","#0CC4BD","#0270E9"]),d=s.map(function(e,t){var n=r[e],o=l(t),a=100*n.length/c.componentIds.length;return{label:"".concat(e,": ").concat(a.toFixed(2),"% (").concat(n.length,")"),material:c.createMaterial(o),value:n.length,shortLabel:e,percent:a,dbIds:n,color:o}}),e.abrupt("return",E()(d,function(e){return-1*e.value}));case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onStopResize",value:function(){var t=this.react.getState();e("#bar-chart-dropdown").parent().find("ul").css({height:Math.min(e(".bar-chart").height()-42,26*t.items.length+16)}),this.react.setState({guid:this.guid()})}},{key:"renderTitle",value:function(){var e=this,t=this.react.getState(),n=t.items.map(function(t,n){return j.a.createElement(b.a,{eventKey:n,key:n,onClick:function(){e.setActiveProperty(t,!0)}},t)}),o={color:t.theming?"#FF0000":"#9b9b9b"};return j.a.createElement("div",{className:"title controls"},j.a.createElement("label",null,"Bar Chart"),j.a.createElement(v.a,{title:"Property: "+t.activeProperty,disabled:t.disabled,key:"bar-chart-dropdown",id:"bar-chart-dropdown"},n),j.a.createElement("button",{onClick:this.toggleTheming,disabled:t.disabled,title:"color theming"},j.a.createElement("span",{className:"fa fa-paint-brush",style:o})))}},{key:"render",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{showTitle:!0},n=this.react.getState();return j.a.createElement(m.a,{renderTitle:this.renderTitle,showTitle:t.showTitle,className:this.className},j.a.createElement(k.a,{show:n.showLoader}),j.a.createElement(O.a,{onGroupClicked:function(t){var n=t.dbIds,o=e.viewer.activeModel||e.viewer.model;e.viewer.isolate(n,o),e.viewer.fitToView()},guid:n.guid,data:n.data}))}},{key:"className",get:function(){return"bar-chart"}}],[{key:"ExtensionId",get:function(){return"Viewing.Extension.BarChart"}}]),n}(h.a);Autodesk.Viewing.theExtensionManager.registerExtension(L.ExtensionId,L)}).call(this,n(18))},500:function(e,t,n){var o=n(501);"string"===typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(21)(o,a);o.locals&&(e.exports=o.locals)},501:function(e,t,n){(e.exports=n(20)(!1)).push([e.i,".bar-chart .title {\n  position: relative !important;\n  background: #fdfdfd;\n  overflow: visible;\n  float: left; }\n\n.bar-chart .title > label {\n  white-space: nowrap;\n  font-weight: normal;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  margin-left: 27px;\n  select: none;\n  width: 85px; }\n\n.bar-chart .title > .dropdown {\n  position: relative;\n  top: -1px; }\n\n.bar-chart .title > button {\n  margin-left: 4px;\n  height: 26px; }\n\n.bar-chart .title .dropdown-menu {\n  overflow: scroll; }\n\n.bar-chart .loader-background {\n  background: #fdfdfd; }\n\n.bar-chart .loader,\n.bar-chart .loader:before,\n.bar-chart .loader:after {\n  top: 35%; }\n\n.bar-chart .loader:before,\n.bar-chart .loader:after {\n  margin: -9px auto; }\n",""])},502:function(e,t,n){"use strict";var o=n(503);t.a=o.a},503:function(e,t,n){"use strict";(function(e){var o=n(4),a=n(5),i=n(8),r=n(7),s=n(9),l=n(0),d=n.n(l),c=(n(504),n(404)),u=n.n(c),h=function(t){function n(e){return Object(o.a)(this,n),Object(i.a)(this,Object(r.a)(n).call(this,e))}return Object(s.a)(n,t),Object(a.a)(n,[{key:"componentDidMount",value:function(){this.draw(this.props.data)}},{key:"shouldComponentUpdate",value:function(e){return e.guid!==this.props.guid}},{key:"componentDidUpdate",value:function(){e(this.container).empty(),this.draw(this.props.data)}},{key:"draw",value:function(t){var n=this;if(t&&t.length){var o=this.container,a=55,i=40,r=50,s=30,l=Math.min(Math.max(e(o).width()-40,30*t.length),100*t.length)-10,d=e(o).height()-93,c=u.a.scale.ordinal().rangeRoundBands([0,l],.1),h=u.a.scale.linear().range([d,0]),p=u.a.svg.axis().scale(c).orient("bottom"),v=u.a.svg.axis().scale(h).orient("left").ticks(10,"%"),f=u.a.select(o).append("svg").attr("width",l+r+i).attr("height",d+s+a).append("g").attr("transform","translate(".concat(r,", ").concat(s,")"));c.domain(t.map(function(e){return e.shortLabel})),h.domain([0,u.a.max(t,function(e){return e.value/1e3})]),f.append("g").attr("class","x axis").attr("transform","translate(0, ".concat(d,")")).call(p).selectAll("text").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform",function(e){return"rotate(-20)"}),f.append("g").attr("class","y axis").call(v).append("text").attr("transform","translate(60, -30)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text("Components (% Total)");var b=u.a.select(this.container).append("div").style("background","#bababa").style("position","absolute").style("border-radius","4px").style("padding","0 10px").style("display","none").style("height","auto").style("opacity",.7),m=null;f.selectAll(".bar-item").data(t).enter().append("rect").attr("class","bar-item").attr("x",function(e){return c(e.shortLabel)}).attr("width",c.rangeBand()).attr("y",function(e){return h(e.value/1e3)}).attr("height",function(e){return d-h(e.value/1e3)}).style("fill",function(e,n){return t[n].color}).on("click",function(e){n.props.onGroupClicked&&n.props.onGroupClicked(e)}).on("mouseover",function(t){b.transition().style("opacity",.9);var n=e(o).offset(),a=u.a.event.pageX-n.left,i=u.a.event.pageY-n.top;b.html(t.label).style("left",a+5+"px").style("top",i+15+"px").style("display","block"),m=this.style.fill,u.a.select(this).style("fill","#6AB8E3").style("opacity",.5)}).on("mousemove",function(t){var n=e(o).offset(),a=u.a.event.pageX-n.left,i=u.a.event.pageY-n.top;b.style("left",a+5+"px").style("top",i+15+"px").style("display","block"),u.a.select(this).style("fill","#6AB8E3").style("opacity",.5)}).on("mouseout",function(e){u.a.select(this).style("fill",m).style("opacity",1),b.style("display","none")})}}},{key:"render",value:function(){var e=this;return d.a.createElement("div",{className:"bar-chart",ref:function(t){return e.container=t}})}}]),n}(d.a.Component);t.a=h}).call(this,n(18))},504:function(e,t,n){var o=n(505);"string"===typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(21)(o,a);o.locals&&(e.exports=o.locals)},505:function(e,t,n){(e.exports=n(20)(!1)).push([e.i,".bar-chart {\n  background-color: #fdfdfd;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  overflow-y: auto;\n  overflow-x: auto;\n  height: 100%;\n  width: 100%; }\n\n.bar-chart .d3.d3-bar {\n  overflow-x: auto; }\n\n.bar-chart .bar-item {\n  cursor: pointer; }\n\n.bar-chart .axis {\n  font: 10px sans-serif; }\n\n.bar-chart .axis path {\n  fill: none;\n  stroke: #000;\n  shape-rendering: crispEdges; }\n\n.bar-chart .axis line {\n  fill: none;\n  stroke: #000;\n  shape-rendering: crispEdges; }\n\n.bar-chart .x.axis path {\n  display: none; }\n",""])}}]);
//# sourceMappingURL=8.60f54fcd.chunk.js.map